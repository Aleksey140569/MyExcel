(()=>{"use strict";class t{constructor(t){this.$el="string"==typeof t?document.querySelector(t):t}html(t){return"string"==typeof t?(this.$el.innerHTML=t,this):this.$el.outerHTML.trim()}clear(){return this.html(""),this}on(t,n){this.$el.addEventListener(t,n)}off(t,n){this.$el.removeEventListener(t,n)}append(n){return n instanceof t&&(n=n.$el),Element.prototype.append?this.$el.append(n):this.$el.appendChild(n),this}}function n(n){return new t(n)}n.create=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const r=document.createElement(t);return e&&r.classList.add(e),n(r)};class e{constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t)throw new Error("No $root provided for DomListener!");this.$root=t,this.listeners=n}initDOMListeners(){this.listeners.forEach((t=>{const n=r(t);if(!this[n])throw new Error("Method ".concat(n," is not \n        implemented in ").concat(this.name," Component!"));this[n]=this[n].bind(this),this.$root.on(t,this[n])}))}removeDOMListeners(){this.listeners.forEach((t=>{const n=r(t);this.$root.off(t,this[n])}))}}function r(t){return"on"+("string"!=typeof(n=t)?"":n.charAt(0).toUpperCase()+n.slice(1));var n}class i extends e{constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,n.listeners),this.name=n.name||""}toHtml(){return""}init(){this.initDOMListeners()}destroy(){this.removeDOMListeners()}}class o extends i{toHTML(){return'\n      <input type="text" class="input" value="Новая таблица">\n      <div>\n        <div class="button">\n          <span class="material-icons">\n            delete\n          </span>\n        </div>\n        <div class="button">\n          <span class="material-icons">\n            exit_to_app\n          </span>\n        </div>\n      </div>\n    '}}var s,a,l,c;s=o,l="excel__header",(a="symbol"==typeof(c=function(t,n){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(a="className"))?c:String(c))in s?Object.defineProperty(s,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):s[a]=l;class u extends i{constructor(t){super(t,{name:"Toolbar",listeners:["click"]})}toHTML(){return'\n      <div class="button">\n        <span class="material-icons">\n          format_align_left\n        </span>\n      </div>\n      <div class="button">\n        <span class="material-icons">\n          format_align_center\n        </span>\n      </div>\n      <div class="button">\n        <span class="material-icons">\n          format_align_right\n        </span>\n      </div>\n      <div class="button">\n        <span class="material-icons">\n          format_bold\n        </span>\n      </div>\n      <div class="button">\n        <span class="material-icons">\n          format_italic\n        </span>\n      </div>\n      <div class="button">\n        <span class="material-icons">\n          format_underlined\n        </span>\n      </div>\n    '}onClick(t){console.log(t.target)}}!function(t,n,e){n=function(t){var n=function(t,n){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof n?n:String(n)}(n),n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}(u,"className","excel__toolbar");class p extends i{constructor(t){super(t,{name:"Formula",listeners:["input","click"]})}toHTML(){return'\n    <div class="info">\n      fx\n    </div>\n    <div class="input" contenteditable spellcheck="false"></div>\n    '}onInput(t){console.log(this.$root),console.log("Formula: onInput",t.target.textContent.trim())}onClick(t){}}!function(t,n,e){n=function(t){var n=function(t,n){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof n?n:String(n)}(n),n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}(p,"className","excel__formula");const m=65,v=90;function d(){return'\n    <div class="cell" contenteditable></div>\n  '}function f(t){return'\n    <div class="column">\n      '.concat(t,'\n      <div class="col-resize"></div>\n    </div>\n  ')}function h(t,n){return'\n    <div class="row">\n      <div class="row-info">\n        '.concat(t||"",'\n      </div>\n      <div class="row-data">\n        ').concat(n,"\n      </div>\n    </div>\n  ")}function b(t,n){return String.fromCharCode(m+n)}class y extends i{constructor(t){super(t,{})}toHTML(){return function(t){const n=v-m+1,e=[],r=new Array(n).fill("").map(b).map(f).join("");e.push(h(null,r));for(let t=0;t<45;t++){const r=new Array(n).fill("").map(d).join("");e.push(h(t+1,r))}return e.join("")}()}}!function(t,n,e){n=function(t){var n=function(t,n){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof n?n:String(n)}(n),n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}(y,"className","excel__table"),new class{constructor(t,e){this.$el=n(t),this.components=e.components||[]}getRoot(){const t=n.create("div","excel");return this.components=this.components.map((e=>{const r=n.create("div",e.className),i=new e(r);return r.html(i.toHTML()),t.append(r),i})),t}render(){this.$el.append(this.getRoot()),this.components.forEach((t=>t.init()))}}("#app",{components:[o,u,p,y]}).render()})();